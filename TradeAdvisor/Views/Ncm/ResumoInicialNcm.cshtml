@model List<TradeAdvisor.Entities.ResumoConsulta>

<div class="container">
    <section id="nav_abas">
        <div>
            <!--bloco produto-->
            <div class="col-xs-12 block_default">
                <div style="width:50%;float:left; margin-top:38px; text-align:center;"><label class="nm_grafico">CIF Total por NCM </label></div>
                <div style="width:50%;float:right;margin-top:38px; text-align:center;"><label class="nm_grafico">Quantidade por NCM</label></div>
                <div class="col-sm-12">

                    <div>
                        <!-- Widget ID (each widget will need unique ID)-->
                        <div class="jarviswidget" id="wid-id-6" data-widget-editbutton="false">

                            <div>
                                <!-- widget edit box -->
                                <div class="jarviswidget-editbox">
                                    <!-- This area used as dropdown edit box -->

                                </div>
                                <!-- end widget edit box -->
                                <!-- widget content -->
                                <div class="widget-body no-padding">

                                    <div id="donut-graph" class="chart no-padding"></div>

                                </div>
                                <!-- end widget content -->

                            </div>
                            <!-- end widget div -->

                        </div>

                        <!-- Widget ID (each widget will need unique ID)-->
                        <div class="jarviswidget" id="wid-id-6" data-widget-editbutton="false">

                            <div>
                                <!-- widget edit box -->
                                <div class="jarviswidget-editbox">
                                    <!-- This area used as dropdown edit box -->

                                </div>
                                <!-- end widget edit box -->
                                <!-- widget content -->
                                <div class="widget-body no-padding">

                                    <div id="donut-graphNcmQuantidade" class="chart no-padding"></div>
                                </div>
                                <!-- end widget content -->

                            </div>
                            <!-- end widget div -->

                        </div>


                        <table class="table table-striped table_trade2">
                            <thead>
                                <tr>
                                    <th>
                                        <strong>Ncm</strong>

                                    </th>
                                    <th>
                                        <strong>Descrição</strong>
                                    </th>
                                    <th>
                                        <strong>CIF Total USD</strong>
                                    </th>
                                    <th>
                                        <strong>Aliquota Total</strong>

                                    </th>
                                    <th>
                                        <strong>Quantidade</strong>
                                    </th>
                                </tr>

                            </thead>

                            <tbody>
                                @foreach (var ncm in @Model.OrderByDescending(c => c.CIFTot).ToList())
                                    {
                                    <tr>
                                        <td>
                                            <a href="@Url.Action("DetalhesImportacao", "Ncm", new { descricao_detalhada_produto = @Request["descricao_detalhada_produto"], ncm = @ncm.ncm })">@ncm.ncm</a>
                                        </td>
                                        <td>
                                            <a href="@Url.Action("DetalhesImportacao", "Ncm", new { descricao_detalhada_produto = @Request["descricao_detalhada_produto"], ncm = @ncm.ncm })">@ncm.tx_ncm_desc</a>
                                        </td>
                                        <td>
                                            $@String.Format("{0:0,0.00}", @ncm.CIFTot)
                                        </td>
                                        <td>
                                            @String.Format("{0:0}", @ncm.vl_ift)%
                                        </td>
                                        <td>
                                            @ncm.countReg
                                        </td>
                                    </tr>
                                    }
                            </tbody>
                        </table>

                    </div>

                </div>

            </div>
        </div>

    </section>
</div>

<script type="text/javascript">
    // PAGE RELATED SCRIPTS

    /*
     * Run all morris chart on this page
     */
    Number.prototype.formatMoney = function(c, d, t){
        var n = this,
            c = isNaN(c = Math.abs(c)) ? 2 : c,
            d = d == undefined ? "." : d,
            t = t == undefined ? "," : t,
            s = n < 0 ? "-" : "",
            i = parseInt(n = Math.abs(+n || 0).toFixed(c)) + "",
            j = (j = i.length) > 3 ? j % 3 : 0;
        return s + (j ? i.substr(0, j) + t : "") + i.substr(j).replace(/(\d{3})(?=\d)/g, "$1" + t) + (c ? d + Math.abs(n - i).toFixed(c).slice(2) : "");
    };

    $(document).ready(function () {

        // DO NOT REMOVE : GLOBAL FUNCTIONS!
        //pageSetUp();


        // donut
        if ($('#donut-graph').length) {
            Morris.Donut({
                element: 'donut-graph',
                data: [
                 @foreach (var ncm in @Model.OrderByDescending(c => c.CIFTot).Take(7).ToList())
                 {
                     @:{
                                                                      @:value: @ncm.CIFTot.ToString().Replace(',','.'),
                                                                      @:label: @ncm.ncm
                                                                      @:},
                 }
                ],
                formatter: function (x) {
                    return '$'+(x).formatMoney(2, ',', '.');
                }
            });
        }
    });

    $(document).ready(function () {

        // DO NOT REMOVE : GLOBAL FUNCTIONS!
        //pageSetUp();


        // donut
        if ($('#donut-graph').length) {
            Morris.Donut({
                element: 'donut-graph',
                data: [
                 @foreach (var ncm in Model.OrderByDescending(c => c.CIFTot).Take(7).ToList())
                 {
                     @:{
                                                                      @:value: @ncm.CIFTot.ToString().Replace(',','.'),
                                                                      @:label: @ncm.ncm
                                                               @:},
                 }
                ],
                formatter: function (x) {
                    return '$'+(x).formatMoney(2, ',', '.');
                }
            });
        }
    });



    $(document).ready(function () {

        // DO NOT REMOVE : GLOBAL FUNCTIONS!
        //pageSetUp();


        // donut
        if ($('#donut-graphNcmQuantidade').length) {
            Morris.Donut({
                element: 'donut-graphNcmQuantidade',
                data: [
                 @foreach (var ncm in Model.OrderByDescending(c => c.countReg).Take(7).ToList())
                {
                @:{
                                                              @:value: @ncm.countReg.ToString().Replace(',', '.'),
                                                              @:label: @ncm.ncm
                                                              @:},
                 }
                ],
                formatter: function (x) {
                    return x;
                }
            });
        }
    });


</script>
